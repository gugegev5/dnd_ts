(this.webpackJsonpdnd_ts=this.webpackJsonpdnd_ts||[]).push([[0],{109:function(e,t,n){e.exports=n(158)},119:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var a,r,c,o=n(0),i=n.n(o),l=n(14),s=n.n(l),u=n(160),m=n(103),d=n(30),y=n(39),p=n(90),g=n(65),f=n(21);!function(e){e.Default="Default",e.Background="Background"}(a||(a={})),function(e){e.Default="0"}(r||(r={})),function(e){e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(c||(c={}));var E=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff"],v={1e3:{itemType:a.Background,itemKey:"1",styles:{position:"static",backgroundColor:"#ffffff",width:"100%",height:"200px",backgroundImage:"url('https://shark.qietv.douyucdn.cn/static/07141652/component/live/player/1.0/res/common/goddess/title-s.png')",backgroundSize:"contain",backgroundRepeat:"no-repeat"}}};function h(e,t){return{itemType:e,itemKey:t,styles:{position:"static",backgroundColor:E[parseInt(t,10)%6],width:"100%",height:"200px",backgroundImage:"url('https://shark.qietv.douyucdn.cn/static/07141652/component/live/player/1.0/res/common/goddess/title-s.png')",backgroundSize:"contain",backgroundRepeat:"no-repeat"}}}var I,b=1001,T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.INSERT:return function(){var n="".concat(b++),a=h(t.sourceItemType,n);return console.log("item style insert",a),Object(f.a)(Object(f.a)({},e),{},Object(g.a)({},n,a))}();case c.UPDATE:var n=e[t.sourceItemKey];return e[t.sourceItemKey].styles=Object(f.a)(Object(f.a)({},n.styles),t.styles),console.log("item style update",t,e),e;case c.DELETE:return Object(f.a)({},e);default:return e}},K=n(42),O=n(63),k=n(53);!function(e){e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(I||(I={}));var j=Object(k.c)({itemType:a.Default,itemKey:r.Default,childrens:[]});function x(e,t){if(e.get("itemKey")!==t){var n=function e(t,n,a){for(var r=0;r<t.size;r++){var c=[].concat(Object(O.a)(a),["".concat(r)]),o=t.get(r);if(o.get("itemKey")===n)return[c,o];c.push("childrens");var i=e(o.get("childrens"),n,c);if(i)return i}return}(e.get("childrens"),t,["childrens"]);return n||[void 0,e]}return[[],e]}var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;if(t.type===I.INSERT){var n=x(e,t.targetItemKey),a=Object(K.a)(n,1),r=a[0];if(r){var c=Object(k.b)({itemType:t.sourceItemType,itemKey:t.sourceItemKey,childrens:[]});return e.updateIn(r.concat("childrens"),(function(e){return e.size?e.push(c):Object(k.a)([c])}))}}else if(t.type===I.DELETE){var o=x(e,t.targetItemKey),i=Object(K.a)(o,1),l=i[0];return l&&l.length?e.removeIn(l):e}return e},A={newItemKey:"1000"},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;return t.type===I.INSERT?{newItemKey:"".concat(parseInt(e.newItemKey,10)+1)}:e},N=Object(y.combineReducers)({Items:T,Compositions:D,ItemKey:w}),S=Object(y.createStore)(N,{Items:v,Compositions:j,ItemKey:A},Object(p.devToolsEnhancer)({})),C=(n(119),n(166)),B=n(161),R=n(163),L=n(164),P=n(165);function U(e,t){var n=e.isOver({shallow:!0}),a=e.canDrop(),r=n&&a,c=null===t||void 0===t?void 0:t.backgroundColor;if(r){return{backgroundColor:c="darkgreen",border:"red 2px dotted"}}return a?{backgroundColor:c=c?"".concat(c,"88"):"darkkhaki"}:{}}var F={backgroundColor:"white",width:"100px",height:"100px"},z=a.Background,M=[a.Background],q=function(e){var t=e.itemKey,n=e.compositionActionName,a=void 0===n?I.UPDATE:n,r=e.children,o=Object(d.b)(),l=Object(d.c)((function(e){var n=e.Items[t];return(null===n||void 0===n?void 0:n.styles)||F}),(function(e,t){return!1})),s=Object(L.a)({item:{type:z,itemKey:t,compositionActionName:a},end:function(e,n){console.log("drag ",a),n.didDrop()||(o({type:I.DELETE,targetItemKey:t,sourceItemType:z}),console.log("bg delete itemKey",t))},collect:function(e){return{opacity:e.isDragging()?.4:1}}}),u=Object(K.a)(s,2),m=u[0].opacity,y=u[1],p=Object(P.a)({accept:M,drop:function(e,n){if(!n.didDrop())if(e.compositionActionName===I.INSERT)o({type:I.INSERT,targetItemKey:t,sourceItemType:e.type,sourceItemKey:e.itemKey});else{var a=n.getDifferenceFromInitialOffset(),r=Math.round(parseInt(l.left||"0",10)+a.x),i=Math.round(parseInt(l.top||"0",10)+a.y);o({type:c.UPDATE,sourceItemKey:e.itemKey,sourceItemType:e.type,styles:{top:i,left:r}}),console.log("relative",a)}},collect:function(e){return{dropStyles:Object(f.a)({},U(e,l))}}}),g=Object(K.a)(p,2),E=g[0].dropStyles,v=g[1];return i.a.createElement("div",{ref:function(e){return y(v(e))},style:Object(f.a)(Object(f.a)({},l),{},{opacity:m},E),"data-itemKey":t},r)},J=function(e){var t=e.itemKey,n=Object(d.b)(),r=Object(d.c)((function(e){var n=e.Items[t];return(null===n||void 0===n?void 0:n.styles)||F}));return i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement("span",{style:{flex:"1 0 70px",textAlignLast:"right"}},"\u5bbd\uff1a"),i.a.createElement(B.a,{value:r.width||"100px",onChange:function(e){n({type:c.UPDATE,sourceItemKey:t,sourceItemType:a.Background,styles:{width:e.target.value}})}})),i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement("span",{style:{flex:"1 0 70px",textAlignLast:"right"}},"\u9ad8\uff1a"),i.a.createElement(B.a,{value:r.height||"200px",onChange:function(e){n({type:c.UPDATE,sourceItemKey:t,sourceItemType:a.Background,styles:{height:e.target.value}})}})),i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement("span",{style:{flex:"1 0 70px",textAlignLast:"right"}},"\u80cc\u666f\u989c\u8272\uff1a"),i.a.createElement(B.a,{value:r.backgroundColor||"#FFFFFF",onChange:function(e){n({type:c.UPDATE,sourceItemKey:t,sourceItemType:a.Background,styles:{backgroundColor:e.target.value}})}})),i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement("span",{style:{flex:"1 0 70px",textAlignLast:"right"}},"\u80cc\u666f\u56fe\uff1a"),i.a.createElement(B.a,{value:r.backgroundImage,onChange:function(e){n({type:c.UPDATE,sourceItemKey:t,sourceItemType:a.Background,styles:{backgroundImage:e.target.value}})}})),i.a.createElement("div",{style:{display:"flex",alignItems:"center"}},i.a.createElement("span",{style:{flex:"1 0 70px",textAlignLast:"right"}},"position\uff1a"),i.a.createElement(R.a,{style:{width:"100%"},defaultValue:"static",onChange:function(e){n({type:c.UPDATE,sourceItemKey:t,sourceItemType:a.Background,styles:{position:e}})}},i.a.createElement(R.a.Option,{value:"static"},"static"),i.a.createElement(R.a.Option,{value:"relative"},"relative"))))},W=function(e){var t=e.itemKey,n=e.compositionActionName;return i.a.createElement(i.a.Fragment,null,i.a.createElement(q,{itemKey:t,compositionActionName:n}),i.a.createElement(J,{itemKey:t}))},_=function(){var e=Object(d.c)((function(e){return e.ItemKey.newItemKey}));return i.a.createElement("div",{className:"left",style:{margin:"0 10px",textAlign:"center",width:"50%"}},i.a.createElement(W,{itemKey:e,compositionActionName:I.INSERT}))},V={textAlign:"center",margin:"0 10px",width:"50%",border:"red solid"};function $(e){var t=e.compositions;return i.a.createElement.apply(i.a,[i.a.Fragment,null].concat(Object(O.a)(function e(t){return t.map((function(t){return i.a.createElement.apply(i.a,[(n=t.get("itemType"),n===a.Background?q:function(){return i.a.createElement("div",null)}),{itemKey:t.get("itemKey")}].concat(Object(O.a)(t.get("childrens").size?e(t.get("childrens")):[])));var n}))}(t))))}var G=[a.Background],H=function(){var e=r.Default,t=Object(d.b)(),n=Object(P.a)({accept:G,drop:function(n,a){a.didDrop()||t({type:I.INSERT,targetItemKey:e,sourceItemType:n.type,sourceItemKey:n.itemKey})},collect:function(e){return{dropStyles:Object(f.a)({},U(e,V))}}}),a=Object(K.a)(n,2),c=a[0].dropStyles,o=a[1],l=Object(d.c)((function(e){return e.Compositions.get("childrens")}),(function(e,t){return Object(k.d)(e,t)}));return i.a.createElement("div",{ref:o,style:Object(f.a)(Object(f.a)({},V),c)},i.a.createElement($,{compositions:l}))},Q=C.a.Content;function X(){return i.a.createElement(C.a,null,i.a.createElement(C.a,{className:"site-layout"},i.a.createElement(Q,{style:{padding:"24px 0",height:"100vh",display:"flex"}},i.a.createElement(_,null),i.a.createElement(H,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(d.a,{store:S},i.a.createElement(u.a,{backend:m.a,debugMode:!0},i.a.createElement(X,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[109,1,2]]]);
//# sourceMappingURL=main.ccc2706a.chunk.js.map